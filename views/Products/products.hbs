{{#> layout }}
<main class="main-content">
  <!-- Hero section (–∫–∞–∫ –≤ index1.html) -->
  <section class="textcontent">
    <h2>Plan & Write / Notebooks & Notepads</h2>
    <h1>Notebooks & Notepads</h1>
    <p>There's nothing like writing in a new kikki.K Notebook...</p>
  </section>

  <!-- –§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
  <section class="filters" style="margin: 24px 0; padding: 0 16px;">
    <form method="GET" style="display: flex; gap: 16px; align-items: end; flex-wrap: wrap;">
      <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è -->
      <div>
        <label for="cat-select">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
        <select name="cat_id" id="cat-select" onchange="this.form.submit()">
          <option value="0">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
          {{#each categories}}
            <option value="{{this.cat_id}}" {{#if (eq this.cat_id ../curCatId)}}selected{{/if}}>
              {{this.cat_name}}
            </option>
          {{/each}}
        </select>
      </div>

      <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
      <div>
        <label for="sort-select">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
        <select name="sort" id="sort-select" onchange="this.form.submit()">
          <option value="">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</option>
          <option value="name-asc" {{#if (eq sort 'name-asc')}}selected{{/if}}>–ù–∞–∑–≤–∞–Ω–∏–µ (–ê‚Üí–Ø)</option>
          <option value="name-desc" {{#if (eq sort 'name-desc')}}selected{{/if}}>–ù–∞–∑–≤–∞–Ω–∏–µ (–Ø‚Üí–ê)</option>
          <option value="price-asc" {{#if (eq sort 'price-asc')}}selected{{/if}}>–¶–µ–Ω–∞ (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é)</option>
          <option value="price-desc" {{#if (eq sort 'price-desc')}}selected{{/if}}>–¶–µ–Ω–∞ (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)</option>
        </select>
      </div>

      <button type="submit" class="wishlist-btn2" style="height: 38px;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    </form>
  </section>

  <!-- –¢–æ–≤–∞—Ä—ã -->
  <section class="products-scroll">
    <h2>
      {{#if curCatId}}
        {{#findCategory categories curCatId}}–¢–æ–≤–∞—Ä—ã: {{.}}{{/findCategory}}
      {{else}}
        –í—Å–µ —Ç–æ–≤–∞—Ä—ã
      {{/if}}
      ({{products.length}})
    </h2>
    <div class="products-grid">
      {{#each products}}
      <a href="/products/{{this.prod_id}}" class="product-card">
        <div class="product-image">
          <img src="/{{this.image_main}}" alt="{{this.prod_name}}">
          {{#if this.image_hover}}
            <img src="/{{this.image_hover}}" class="hover">
          {{/if}}
          <button class="wishlist-btn">‚ù§</button>
        </div>
        <h3>{{this.prod_name}}</h3>
        <p class="price">${{this.price}}</p>
        <a href="/sales/addToCart/{{this.prod_id}}" class="add-cart-btn">+ Bag</a>
      </a>
      <div class="product-actions" style="margin-top: 8px;">
        <a href="/products/edit/{{this.prod_id}}" class="wishlist-btn2" style="font-size: 12px; padding: 4px 8px;">‚úèÔ∏è –†–µ–¥.</a>
      </div>
      <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è -->
      <form action="/products/delete/{{this.prod_id}}" method="POST" style="display: inline;">
        <button 
          type="submit" 
          class="delete-btn"
          onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä ¬´{{this.prod_name}}¬ª –∏ –≤—Å–µ –µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è?')"
          style="background: none; border: none; color: #e74c3c; cursor: pointer; font-size: 14px; margin-left: 8px;"
        >
          üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
        </button>
      </form>
      {{/each}}

      {{#unless products.length}}
        <p style="grid-column: 1/-1; text-align: center; color: #777;">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
      {{/unless}}
    </div>
  </section>
</main>

<!-- –•–µ–ª–ø–µ—Ä –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ ID -->
<script>
  // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º selected –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–∫–∞–∫ –≤ –¢–ó)
  document.addEventListener('DOMContentLoaded', () => {
    const catSelect = document.getElementById('cat-select');
    const sortSelect = document.getElementById('sort-select');
    // –í—ã–±–æ—Ä —É–∂–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω —á–µ—Ä–µ–∑ Handlebars, –Ω–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π:
    if (catSelect) catSelect.value = '{{curCatId}}';
    if (sortSelect) sortSelect.value = '{{sort}}';
  });
</script>
{{/layout}}